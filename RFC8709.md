---
description: RFC 8709 - SSH协议中的Ed25519和Ed448公钥算法标准文档，由B. Harris和L. Velvindron于2020年2月发布，定义了如何在SSH协议中使用Ed25519和Ed448数字签名算法，更新了RFC 4253，为SSH提供了现代化的公钥认证方案
keywords:
  - RFC8709
  - SSH
  - Ed25519
  - Ed448
  - ssh-ed25519
  - ssh-ed448
  - 公钥认证
  - 数字签名
  - OpenSSH
  - 安全外壳协议
  - 椭圆曲线密码学
  - SSHFP
  - DNS资源记录
properties:
  rfc_number: 8709
  title: "Ed25519 and Ed448 Public Key Algorithms for the Secure Shell (SSH) Protocol"
  authors:
    - name: "B. Harris"
    - name: "L. Velvindron"
      organization: "cyberstorm.mu"
  publication_date: "2020-02"
  status: "标准轨道"
  category: "SSH协议扩展"
  updates: "RFC 4253"
  related_rfc:
    - "RFC 4251"
    - "RFC 4253"
    - "RFC 8032"
    - "RFC 7748"
---
# RFC 8709 - SSH协议中的Ed25519和Ed448公钥算法

## 文档概述

RFC 8709是由B. Harris和cyberstorm.mu的L. Velvindron于2020年2月发布的互联网标准轨道文档，标题为"Ed25519 and Ed448 Public Key Algorithms for the Secure Shell (SSH) Protocol"（SSH协议中的Ed25519和Ed448公钥算法）。该文档描述了如何在SSH协议中使用Ed25519和Ed448数字签名算法进行服务器和用户认证。

该文档更新了RFC 4253（SSH传输层协议），正式化了OpenSSH 6.5引入的"ssh-ed25519"算法名称，并新增了"ssh-ed448"算法的规范。这些现代椭圆曲线算法为SSH提供了比传统RSA和DSA更高效、更安全的公钥认证方案。

## 历史背景

### SSH协议的演进

SSH（Secure Shell）是最重要的远程登录协议之一：

**早期SSH密钥类型**：
- **ssh-rsa**：基于RSA算法，最早支持
- **ssh-dss**：基于DSA算法，已被弃用
- **ecdsa-sha2-***：基于NIST椭圆曲线

**传统算法的问题**：
- RSA密钥较大（通常2048-4096位）
- DSA存在安全问题，已不推荐使用
- NIST曲线存在争议和信任问题
- 性能不够理想

### OpenSSH的创新

**OpenSSH 6.5的突破（2014年）**：
- 首次引入Ed25519支持
- 实现了ssh-ed25519密钥类型
- 提供了更快、更安全的认证方式
- 迅速被其他SSH实现采用

**社区需求**：
- 需要标准化ssh-ed25519的使用
- 需要正式的RFC规范
- 需要扩展到Ed448算法
- 需要更新SSH协议标准

## ssh-ed25519算法规范

### 公钥格式

**ssh-ed25519密钥编码**：
```
string  "ssh-ed25519"
string  key
```

**密钥参数**：
- 密钥长度：32字节（256位）
- 基于RFC 8032第5.1.5节定义的Ed25519公钥
- 使用SSH字符串格式编码

**与RSA对比**：
- RSA-2048公钥：约256字节
- Ed25519公钥：32字节
- 大小减少8倍

### 签名格式

**ssh-ed25519签名编码**：
```
string  "ssh-ed25519"
string  signature
```

**签名参数**：
- 签名长度：64字节（512位）
- 按照RFC 8032第5.1.6节生成
- 使用RFC 8032第5.1.7节验证

**签名过程**：
- 使用Ed25519算法对SSH会话数据签名
- 确定性签名，无需随机数
- 快速生成和验证

## ssh-ed448算法规范

### 公钥格式

**ssh-ed448密钥编码**：
```
string  "ssh-ed448"
string  key
```

**密钥参数**：
- 密钥长度：57字节（456位）
- 基于RFC 8032第5.2.5节定义的Ed448公钥
- 提供约224位安全级别

### 签名格式

**ssh-ed448签名编码**：
```
string  "ssh-ed448"
string  signature
```

**签名参数**：
- 签名长度：114字节（912位）
- 按照RFC 8032第5.2.6节生成
- 使用RFC 8032第5.2.7节验证

## SSHFP DNS资源记录

RFC 8709定义了如何为Ed448密钥生成SSHFP DNS资源记录。

### SSHFP记录用途

**功能**：
- 在DNS中发布SSH主机密钥指纹
- 客户端可以验证服务器密钥的真实性
- 防止中间人攻击

**Ed25519的SSHFP**：
- 已在RFC 7479中定义
- 算法编号：4

### Ed448的SSHFP记录

**新增定义**：
- RFC 8709为Ed448分配算法编号：6
- 使用SHA-256哈希（类型2）

**示例记录**：
```
example.com. IN SSHFP 6 2 ( a87f1b687ac0e57d2a081a2f2826723
                            34d90ed316d2b818ca9580ea384d924
                            01 )
```

**记录格式**：
- 第一个数字（6）：Ed448算法
- 第二个数字（2）：SHA-256哈希
- 括号内：公钥的SHA-256指纹

## 实际应用

### OpenSSH实现

**密钥生成**：
```bash
# 生成Ed25519密钥
ssh-keygen -t ed25519 -C "user@example.com"

# 生成Ed448密钥
ssh-keygen -t ed448 -C "user@example.com"
```

**密钥文件**：
- 私钥：~/.ssh/id_ed25519 或 id_ed448
- 公钥：~/.ssh/id_ed25519.pub 或 id_ed448.pub
- 公钥文件非常小，便于分发

### 与传统SSH密钥的对比

**密钥大小对比**：
- RSA-2048：公钥~256字节，私钥~1679字节
- Ed25519：公钥32字节，私钥64字节
- Ed448：公钥57字节，私钥114字节

**性能对比**：
- Ed25519密钥生成几乎瞬间完成
- RSA-2048密钥生成需要数秒
- SSH连接建立速度更快
- 服务器CPU负载更低

**安全性对比**：
- Ed25519提供约128位安全级别
- Ed448提供约224位安全级别
- RSA-2048提供约112位安全级别
- 更好的侧信道攻击防护

## 总结

RFC 8709将OpenSSH的创新正式纳入SSH协议标准，为SSH提供了现代化的公钥认证方案。

**核心贡献**：

1. **标准化ssh-ed25519**：正式化了OpenSSH 6.5引入的Ed25519支持，确保不同SSH实现之间的互操作性。

2. **引入ssh-ed448**：为需要更高安全级别的应用提供了选择。

3. **完善SSHFP支持**：定义了Ed448的DNS资源记录，增强了SSH密钥验证机制。

**实际优势**：

- **更小的密钥**：Ed25519公钥仅32字节，便于存储和传输
- **更快的性能**：密钥生成和认证速度显著提升
- **更强的安全**：基于现代椭圆曲线，提供更好的安全保证
- **简化管理**：密钥文件小，易于备份和管理

**广泛采用**：

ssh-ed25519已成为SSH的推荐密钥类型，被主流SSH实现广泛支持，包括OpenSSH、PuTTY、Dropbear等。许多组织和个人已将其作为默认SSH密钥类型。

## 参考资料

**核心RFC**：
- RFC 8709: Ed25519 and Ed448 Public Key Algorithms for SSH
- RFC 4251: The Secure Shell (SSH) Protocol Architecture
- RFC 4253: The Secure Shell (SSH) Transport Layer Protocol
- RFC 8032: Edwards-Curve Digital Signature Algorithm (EdDSA)
- RFC 7748: Elliptic Curves for Security

**SSHFP相关RFC**：
- RFC 4255: Using DNS to Securely Publish SSH Key Fingerprints
- RFC 7479: Using Ed25519 in SSHFP Resource Records
- RFC 6594: Use of SHA-256 Algorithm with RSA, DSA, and ECDSA in SSHFP

**SSH实现**：
- OpenSSH: 最流行的SSH实现，6.5版本开始支持Ed25519
- PuTTY: Windows平台SSH客户端
- Dropbear: 轻量级SSH实现
- libssh: SSH协议库

**相关工具**：
- ssh-keygen: SSH密钥生成工具
- ssh-copy-id: 公钥部署工具
- ssh-agent: SSH密钥管理代理

