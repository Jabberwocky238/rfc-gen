---
description: RFC 3013 - 推荐的互联网服务提供商安全服务和程序，由T. Killalea于2000年11月发布，表达了IETF工程社区对ISP在安全方面的期望，涵盖通信渠道、适当使用政策、网络基础设施安全、系统基础设施管理等最佳实践建议
keywords:
  - RFC3013
  - ISP安全
  - 互联网服务提供商
  - Internet Service Provider
  - 安全最佳实践
  - Best Current Practice
  - BCP 46
  - 安全事件响应
  - CSIRT
  - 适当使用政策
  - AUP
  - 入口过滤
  - Ingress Filtering
  - 出口过滤
  - Egress Filtering
  - 路由安全
  - 邮件中继
  - SMTP认证
  - 网络安全
  - 安全通信
properties:
  rfc_number: 3013
  title: "Recommended Internet Service Provider Security Services and Procedures"
  authors:
    - name: "T. Killalea"
      organization: "neart.org"
  publication_date: "2000-11"
  status: "最佳当前实践"
  bcp: 46
  category: "ISP安全指南"
  related_rfc:
    - "RFC 2119"
    - "RFC 2142"
    - "RFC 2350"
    - "RFC 2827"
    - "RFC 2644"
---
# RFC 3013 - 推荐的互联网服务提供商安全服务和程序

## 文档概述

RFC 3013是由Tom Killalea于2000年11月发布的最佳当前实践（BCP 46）文档，标题为"Recommended Internet Service Provider Security Services and Procedures"（推荐的互联网服务提供商安全服务和程序）。

该文档的目的是表达IETF代表的工程社区对互联网服务提供商（ISP）在安全方面的期望。文档不是为所有ISP定义一套适用的要求，而是提高ISP对社区期望的认识，并为社区提供一个与当前和潜在服务提供商讨论安全期望的框架。

**核心目标**：
- 鼓励ISP主动将安全作为优先事项
- 使安全成为ISP销售服务时引以为豪的特点
- 为用户提供评估高质量服务提供商的标准
- 不强制规定商业实践

## 历史背景

### 互联网安全环境

在2000年RFC 3013发布时，互联网正经历快速增长，同时面临日益严重的安全威胁：
- 拒绝服务（DoS）攻击日益频繁
- IP地址欺骗被广泛用于攻击
- 垃圾邮件（UBE）问题严重
- 网络基础设施安全意识不足

### ISP的角色演变

ISP从单纯的连接提供商演变为互联网生态系统的关键参与者：
- 管理网络基础设施
- 提供各种互联网服务
- 承担安全责任
- 需要应对安全事件

### 文档的必要性

RFC 3013的编写动机包括：
1. **标准化期望**：明确社区对ISP安全实践的期望
2. **提高意识**：促使ISP重视安全问题
3. **指导框架**：为ISP提供安全实践指南
4. **用户权益**：帮助用户选择安全可靠的服务提供商

## ISP的定义

RFC 3013中对ISP的定义包括：
- 提供互联网连接服务的组织
- 提供其他互联网服务的组织，包括但不限于：
  - Web托管服务
  - 内容提供商
  - 电子邮件服务

**不包括**：为自身目的提供这些服务的组织

## 文档约定

RFC 3013使用RFC 2119中定义的关键词：
- **REQUIRED / MUST**：绝对要求
- **SHOULD**：强烈建议，但在特定情况下可能有正当理由忽略
- **SHOULD NOT**：强烈不建议
- **MAY**：可选项

## 通信

社区对ISP最重要的安全相关期望涉及处理安全事件的通信渠道的可用性。

### 联系信息

**RFC 2142标准**：

ISP应该遵守RFC 2142，该标准定义了以下邮箱：
- **SECURITY**：用于网络安全问题
- **ABUSE**：用于与不当公共行为相关的问题
- **NOC**：用于与网络基础设施相关的问题

RFC 2142还列出了用于接收与特定服务相关的查询和报告的其他邮箱。

**扩展信息**：

ISP可以考虑使用通用URL提供上述内容的扩展详细信息，例如：
```
http://www.ISP-name-here.net/security/
```

**注册信息维护**：

ISP有责任确保其联系信息完整、准确且可达，包括：
- Whois数据库
- 路由注册表（RFC 1786）
- 任何其他存储库

### 信息共享

ISP应该制定明确的政策和程序，规定在以下情况下如何共享安全事件信息：
- 与客户共享
- 与其他ISP共享
- 与事件响应团队共享
- 与执法机构共享
- 与媒体和公众共享

ISP应该建立流程来处理跨越ISP边界的安全事件。

### 安全通信渠道

ISP应该能够通过安全渠道进行此类通信。但是，需要注意的是，在某些司法管辖区，安全渠道可能不被允许。

### 漏洞通知和事件报告

**主动通知**：

ISP应该主动通知客户其提供的服务中的安全漏洞。此外，当发现系统和软件中的新漏洞时，应指出其服务是否受到这些风险的威胁。

**事件报告**：

当影响ISP基础设施组件的安全事件发生时，ISP应及时向客户报告：
- 谁在协调事件响应
- 漏洞是什么
- 服务如何受到影响
- 正在采取什么措施来响应事件
- 客户数据是否可能已被泄露
- 正在采取什么措施来消除漏洞
- 预期的响应时间表（如果可以预测）

**通知渠道**：

许多ISP已经建立了通知客户中断和服务降级的程序。ISP可以合理地使用这些渠道报告安全相关事件。在这种情况下，客户的安全联系人可能不是被通知的人，而是正常联系人将收到报告。客户应该意识到这一点，并确保适当地路由此类通知。

### 事件响应和CSIRT

**CSIRT定义**：

计算机安全事件响应团队（CSIRT）是执行、协调和支持对涉及定义选区内站点的安全事件的响应的团队。互联网社区对CSIRT的期望在RFC 2350"计算机安全事件响应的期望"中描述。

**ISP的事件响应能力**：

无论ISP是否有CSIRT，他们都应该有一个广为人知的方式来接收和处理客户报告的事件。此外，他们应该清楚地记录其响应报告事件的能力，并应指出是否有任何CSIRT的选区包括客户，以及可以向其报告事件。

**CSIRT服务的可用性**：

一些ISP有CSIRT。但是，不应假设ISP的连接客户或被该ISP客户攻击的站点可以自动获得ISP CSIRT的服务。ISP CSIRT通常作为附加成本服务提供，团队将其选区定义为仅那些专门订阅（并可能付费）事件响应服务的人。

**客户应了解的信息**：

客户应该了解其ISP提供哪些事件响应和安全资源，以便在事件发生之前定义其事件响应升级链。客户应该了解其ISP是否有CSIRT，如果有，该团队的章程、政策和服务是什么。此信息最好使用RFC 2350附录D中显示的CSIRT模板表达。

## 适当使用政策（AUP）

### 政策要求

每个ISP都应该有适当使用政策（AUP）。

当ISP与客户签订提供互联网连接的合同时，该合同应受AUP管辖。AUP应在每次合同续签时进行审查，此外，ISP应在政策更新时主动通知客户。

### 政策内容

AUP应明确标识客户在系统或网络的各个组件上应该和不应该做什么，包括网络上允许的流量类型。AUP应尽可能明确，以避免歧义或误解。

**示例**：AUP可能禁止IP欺骗。

### 政策公告

除了向客户传达AUP外，ISP还应在公共场所（如其网站）发布其政策，以便社区了解ISP认为什么是适当的，并知道在发生不当行为时可以期待什么行动。

### 制裁措施

AUP应明确说明在发生不当行为时将执行什么制裁措施。

### 数据保护

许多司法管辖区都有数据保护立法。在适用此类立法的地方，ISP应考虑其持有的个人数据，如有必要，将自己注册为数据控制者，并准备仅按照立法条款使用数据。

鉴于互联网的全球性质，位于没有此类立法的地方的ISP至少应通过阅读典型的数据保护法（例如英国1998年数据保护法）来熟悉数据保护的概念。

## 网络基础设施

ISP负责管理互联网的网络基础设施，使其：
- 对已知的安全漏洞具有合理的抵抗力
- 不容易被攻击者劫持用于后续攻击

### 注册数据维护

ISP通常负责维护存储在全球存储库中的数据，例如：
- 互联网路由注册表（IRR）
- APNIC、ARIN和RIPE数据库

**更新认证**：

对这些数据的更新应该只能使用强认证进行。

**地址空间注册**：

ISP应该公开注册分配给客户的地址空间，以便为委派的空间提供更具体的联系信息。

### 路由基础设施

**路由注册表**：

ISP将流量路由到正确目的地的能力可能取决于路由注册表（RFC 1786）中配置的路由策略。如果是这样，并且注册表支持，他们应该确保：
- 维护的注册表信息只能使用强认证更新
- 进行更新的权限受到适当限制

**路由公告信任**：

在有多条到达目的地的路由可用时，应谨慎确定更信任谁的路由公告。过去，虚假公告导致流量被"黑洞"化，或更糟的是被劫持。

**BGP认证**：

应该与路由对等方使用BGP认证（RFC 2385）。

### 源地址入口过滤

**过滤方向**：从边缘站点（客户）到互联网。

**攻击背景**：

攻击者经常通过使用伪造的源地址来掩盖其踪迹。为了转移对自己站点的注意力，他们选择的源地址通常来自无辜的远程站点，或者来自为私有互联网分配的地址（RFC 1918）。此外，伪造的源地址经常用于基于欺骗的攻击，以利用主机之间的信任关系。

**实施建议**：

为了减少依赖伪造源地址的攻击的发生率，ISP应该执行以下操作。在与每个客户的边界路由器上，他们应该主动过滤来自客户的所有流量，这些流量的源地址不是分配给该客户的地址。有关此主题的更详细讨论，请参阅RFC 2827。

**特殊情况**：

存在（罕见的）入口过滤目前不可能的情况，例如在无法承受应用数据包过滤器额外负载的大型聚合路由器上。此外，此类过滤可能会给移动用户带来困难。因此，虽然强烈鼓励使用此技术来防止欺骗，但它可能并不总是可行的。

在客户和ISP之间的接口上无法进行入口过滤的罕见情况下，应鼓励客户在其网络内实施入口过滤。一般来说，过滤应尽可能靠近实际主机进行。

### 源地址出口过滤

**过滤方向**：从互联网到边缘站点（客户）。

**攻击背景**：

当今互联网上广泛使用的许多应用程序仅基于IP地址授予对其他主机的信任（例如Berkeley 'r'命令）。这些应用程序容易受到IP欺骗攻击。此外，还存在依赖于滥用所谓本地地址的漏洞，例如'land'攻击。

**实施建议**：

为了减少客户遭受依赖伪造源地址的攻击的风险，ISP应该执行以下操作。在与每个客户的边界路由器上，他们应该主动过滤所有发往客户的流量，这些流量的源地址是分配给该客户的任何地址。

**可行性**：

第4.3节中描述的入口过滤不可行的情况同样适用于出口过滤。

### 路由过滤

**DoS攻击风险**：

过多的路由更新可能被攻击者用作拒绝服务攻击的基础负载。至少它们会导致性能下降。

**过滤建议**：

ISP应该过滤他们听到的路由公告，例如：
- 忽略到为私有互联网分配的地址的路由
- 避免虚假路由
- 实施"BGP路由抖动抑制"（RFC 2439）
- 实施聚合策略

**降低路由负载**：

ISP应该实施降低对网络其他部分路由造成过度负载风险的技术。这些包括：
- '钉住'的路由
- 积极的聚合
- 路由抑制

所有这些都降低了当内部路由以与他人无关的方式更改时对其他人的影响。

### 定向广播

**协议特性**：

IP协议允许定向广播，即跨网络发送数据包以在特定子网上广播。

**安全风险**：

此功能的实际用途很少，但几种不同的安全攻击（主要是利用广播的数据包倍增效应的拒绝服务攻击）使用它。

**强制要求**：

因此，连接到广播介质的路由器**不得**配置为允许定向广播到该介质（RFC 2644）。

## 系统基础设施

ISP管理其系统的方式对其网络的安全性和可靠性至关重要。系统的破坏可能最低限度导致性能或功能下降，但可能导致数据丢失或流量被窃听的风险（从而导致"中间人"攻击）。

广泛接受的是，如果将不同的服务（如邮件、新闻和Web托管）保持在单独的系统上，则更容易构建安全系统。

### 系统管理

**访问控制**：

所有执行关键ISP功能（如邮件、新闻和Web托管）的系统都应受到限制，以便只有这些服务的管理员才能访问它们。

**认证要求**：

该访问应仅在强认证后授予，并应通过加密链接进行。

**端口限制**：

只有这些服务侦听的端口应该可以从ISP系统网络外部访问。

**安全更新**：

ISP应该随时了解提供服务的更安全方法（例如，用于简单质询/响应的IMAP/POP授权扩展，RFC 2195）。

### 传输网络上无系统

系统不应连接到传输网络段。

### 开放邮件中继

ISP应该采取积极措施防止其邮件基础设施被"垃圾邮件发送者"用于注入未经请求的批量电子邮件（UBE），同时隐藏发送者的身份（RFC 2505）。

虽然并非所有预防措施都适合每个站点，但应使用最有效的适合站点的方法。

ISP还应强烈鼓励其客户采取必要措施防止其自己系统上的此类活动。

### 消息提交

**SMTP AUTH**：

消息提交应使用"SMTP服务扩展用于认证"（RFC 2554）中描述的AUTH SMTP服务扩展进行认证。

**优于IP地址限制**：

SMTP AUTH优于基于IP地址的提交限制，因为它为ISP的客户提供了灵活性，即使在不通过ISP网络连接时（例如在工作时）也能够提交邮件，更能抵抗欺骗，并且可以在新的认证机制可用时升级到它们。

**消息提交端口**：

此外，为了便于执行安全策略，强烈建议使用"消息提交"（RFC 2476）中讨论的MAIL SUBMIT端口（587）提交消息，而不是通过SMTP端口（25）。这样，SMTP端口（25）可以限制为仅本地传递。

**原因**：

这样做的原因是能够区分入站本地传递和中继（即允许客户通过ISP的SMTP服务向互联网上的任意接收者发送电子邮件）。非认证SMTP应仅允许用于本地传递。

**未来趋势**：

随着越来越多的邮件客户端支持SMTP AUTH和消息提交端口（显式或通过配置SMTP端口），ISP可能会发现要求客户使用提交端口和SMTP AUTH提交消息很有用；仅允许端口25上的入站邮件。

**问责性**：

这些措施（SMTP AUTH和提交端口）不仅保护ISP免于通过第三方中继成为UBE注入点，而且还有助于在客户发送UBE的情况下跟踪消息提交的问责性。

## 文档意义与影响

### 标准化安全期望

RFC 3013的最重要贡献是为ISP安全实践建立了社区期望的基准。它不是强制性标准，而是最佳实践指南，帮助ISP理解其在互联网安全生态系统中的责任。

### 对ISP行业的影响

文档发布后对ISP行业产生了积极影响：
- 提高了ISP对安全问题的重视程度
- 促进了安全实践的标准化
- 为客户评估ISP提供了标准
- 推动了安全服务的商业化

### 技术实践的推广

RFC 3013推广了多项重要的安全技术实践：
- **入口/出口过滤**：成为防止IP欺骗的标准做法
- **BGP认证**：提高了路由安全意识
- **SMTP认证**：推动了邮件安全的发展
- **事件响应流程**：标准化了安全事件处理

## 安全考虑

RFC 3013在"Security Considerations"部分简要说明：本文档整体讨论安全问题。

这是恰当的，因为整个文档的目的就是提供ISP安全服务和程序的建议。

## 致谢

RFC 3013感谢以下人员提供的建设性意见：
- Nevil Brownlee
- Randy Bush
- Bill Cheswick
- Barbara Y. Fraser
- Randall Gellens
- Erik Guttman
- Larry J. Hughes Jr.
- Klaus-Peter Kossakowski
- Michael A. Patton
- Don Stikvoort
- Bill Woodcock

## 总结

RFC 3013作为ISP安全最佳实践指南，成功地为互联网服务提供商建立了安全服务和程序的期望框架。文档不是强制性标准，而是表达工程社区对ISP在安全方面的期望，鼓励ISP主动将安全作为优先事项。

**核心贡献**：

1. **通信渠道**：强调建立清晰的安全联系信息和事件响应机制
2. **适当使用政策**：要求ISP制定和公布明确的AUP
3. **网络基础设施安全**：推广入口/出口过滤、路由安全等关键技术
4. **系统基础设施管理**：强调系统安全、访问控制和邮件安全
5. **事件响应能力**：明确CSIRT的角色和ISP的响应责任

**实践价值**：

虽然文档发布于2000年，其核心原则在今天仍然具有重要价值：
- 安全通信渠道的重要性
- 主动的安全态度
- 透明的政策和程序
- 技术防护措施的实施
- 事件响应的准备

RFC 3013为ISP和客户之间建立了关于安全期望的共同语言，促进了互联网安全生态系统的健康发展。它展示了如何通过社区共识和最佳实践指南来提升整个行业的安全水平，而不是依赖强制性法规。

## 参考资料

1. RFC 2119: Key words for use in RFCs to Indicate Requirement Levels

2. RFC 2142: Mailbox Names for Common Services, Roles and Functions

3. RFC 2350: Expectations for Computer Security Incident Response

4. RFC 1786: Representation of IP Routing Policies in a Routing Registry

5. RFC 1918: Address Allocation for Private Internets

6. RFC 2385: Protection of BGP Sessions via the TCP MD5 Signature Option

7. RFC 2827: Network Ingress Filtering: Defeating Denial of Service Attacks which employ IP Source Address Spoofing

8. RFC 2439: BGP Route Flap Damping

9. RFC 2644: Changing the Default for Directed Broadcasts in Routers

10. RFC 2505: Anti-Spam Recommendations for SMTP MTAs

11. RFC 2554: SMTP Service Extension for Authentication

12. RFC 2476: Message Submission

13. RFC 2195: IMAP/POP AUTHorize Extension for Simple Challenge/Response

14. UK Data Protection Act 1998
