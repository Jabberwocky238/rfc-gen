---
description: RFC 2313 - PKCS #1 RSA加密标准版本1.5，由RSA实验室的Burton S. Kaliski Jr.于1998年3月发布，定义了使用RSA公钥密码系统进行数据加密的方法，包括密钥生成、加密解密过程、数字签名算法，是RSA算法在互联网标准中的首次正式定义
keywords:
  - RFC2313
  - PKCS #1
  - RSA
  - RSA Encryption
  - 公钥加密
  - Public Key Cryptography
  - 数字签名
  - Digital Signature
  - 密钥生成
  - Key Generation
  - 加密算法
  - Cryptography
  - RSA Laboratories
  - Burton Kaliski
  - 非对称加密
  - Asymmetric Encryption
  - 数字信封
  - Digital Envelope
  - X.509
  - ASN.1
properties:
  rfc_number: 2313
  title: "PKCS #1: RSA Encryption Version 1.5"
  authors:
    - name: "Burton S. Kaliski Jr."
      organization: "RSA Laboratories East"
  publication_date: "1998-03"
  status: "信息性备忘录（已被RFC 2437和RFC 3447取代）"
  category: "密码学标准"
  obsoleted_by: "RFC 2437, RFC 3447"
  related_rfc:
    - "RFC 1319"
    - "RFC 1320"
    - "RFC 1321"
    - "RFC 1423"
    - "RFC 2437"
    - "RFC 3447"
---
# RFC 2313 - PKCS #1: RSA加密标准 Version 1.5

## 文档概述

RFC 2313是由RSA实验室东部分部的Burton S. Kaliski Jr.于1998年3月发布的信息性备忘录，标题为"PKCS #1: RSA Encryption Version 1.5"。该文档是RSA算法在RFC系列中的首次正式标准化定义，描述了使用RSA公钥密码系统进行数据加密的方法。

PKCS（Public-Key Cryptography Standards，公钥密码学标准）是由RSA实验室制定的一系列公钥密码学标准。PKCS #1专门定义了RSA加密和签名的标准格式和过程。RFC 2313定义的Version 1.5是该标准的一个重要版本，广泛应用于数字签名和数字信封的构建。

**主要应用场景**：

1. **数字签名**：内容首先使用消息摘要算法（如MD5）生成摘要，然后用RSA私钥加密摘要
2. **数字信封**：内容首先用对称加密算法（如DES）加密，然后用RSA公钥加密对称密钥

## 历史背景

### RSA算法的诞生

1977年，Ron Rivest、Adi Shamir和Leonard Adleman在麻省理工学院（MIT）发明了RSA算法，这是第一个既能用于加密又能用于数字签名的公钥算法。RSA算法的名称来自三位发明者姓氏的首字母。

### PKCS标准的发展

1991年，RSA实验室开始制定PKCS系列标准，旨在促进公钥密码学技术的部署和互操作性。PKCS #1作为该系列的第一个标准，专门定义了RSA的使用方法。

### RFC 2313的意义

RFC 2313是RSA算法首次在IETF RFC系列中正式标准化。在此之前，RSA的使用主要依赖于RSA实验室发布的PKCS文档。RFC 2313的发布使得RSA标准成为互联网标准的一部分，促进了其在互联网应用中的广泛采用。

**时间线**：
- 1977年：RSA算法发明
- 1983年：RSA算法获得美国专利
- 1991年：PKCS #1首次发布
- 1998年：RFC 2313发布（PKCS #1 v1.5）
- 2000年：RSA专利到期，进入公共领域

## 核心概念

### 公钥密码学基础

RSA是一种非对称加密算法，使用一对密钥：
- **公钥（Public Key）**：可以公开，用于加密或验证签名
- **私钥（Private Key）**：必须保密，用于解密或生成签名

**基本原理**：
- 用公钥加密的数据只能用对应的私钥解密
- 用私钥加密的数据只能用对应的公钥解密
- 从公钥无法推导出私钥

### RSA数学基础

RSA算法基于大整数因式分解的困难性：

**密钥组成**：
- **模数（n）**：两个大素数p和q的乘积，n = p × q
- **公钥指数（e）**：与(p-1)和(q-1)互质的整数
- **私钥指数（d）**：满足 d × e ≡ 1 (mod (p-1)(q-1))

**加密解密**：
- 加密：c = m^e mod n
- 解密：m = c^d mod n

## 密钥生成

### 密钥生成步骤

RFC 2313定义了RSA密钥对的生成过程：

1. **选择公钥指数e**：选择一个正整数作为公钥指数

2. **选择素数p和q**：
   - 私密且随机地选择两个不同的奇素数p和q
   - 确保(p-1)与e互质
   - 确保(q-1)与e互质

3. **计算模数n**：n = p × q

4. **计算私钥指数d**：
   - d是一个正整数
   - 满足 de - 1 能被(p-1)和(q-1)整除

5. **确定模数长度k**：
   - k是模数n的字节长度
   - 满足 2^(8(k-1)) ≤ n < 2^(8k)
   - k至少为12字节

### 常用公钥指数

**标准化的e值**：
- **3**：计算效率最高，但需要特别注意填充
- **65537 (F4)**：平衡了安全性和效率，最常用

### 安全考虑

**素数选择**：
- 应考虑额外的安全条件以防止模数分解
- p和q应该足够大且相差不能太小
- 最小长度k=12字节是为了容纳块格式，而非安全要求

## 密钥语法

### 公钥语法

RSA公钥使用ASN.1类型RSAPublicKey：

```asn1
RSAPublicKey ::= SEQUENCE {
  modulus INTEGER,        -- n
  publicExponent INTEGER  -- e
}
```

**字段说明**：
- `modulus`：模数n
- `publicExponent`：公钥指数e

### 私钥语法

RSA私钥使用ASN.1类型RSAPrivateKey：

```asn1
RSAPrivateKey ::= SEQUENCE {
  version Version,
  modulus INTEGER,           -- n
  publicExponent INTEGER,    -- e
  privateExponent INTEGER,   -- d
  prime1 INTEGER,            -- p
  prime2 INTEGER,            -- q
  exponent1 INTEGER,         -- d mod (p-1)
  exponent2 INTEGER,         -- d mod (q-1)
  coefficient INTEGER        -- (inverse of q) mod p
}

Version ::= INTEGER
```

**字段说明**：
- `version`：版本号，此版本为0
- `modulus`：模数n
- `publicExponent`：公钥指数e
- `privateExponent`：私钥指数d
- `prime1`：素数因子p
- `prime2`：素数因子q
- `exponent1`：d mod (p-1)
- `exponent2`：d mod (q-1)
- `coefficient`：中国剩余定理系数 q^(-1) mod p

**效率优化**：
- 私钥中包含p、q等额外值是为了提高解密效率
- 使用中国剩余定理（CRT）可以显著加速私钥操作
- 这些额外值不是逻辑上必需的，但能提供4倍左右的性能提升

## 加密过程

### 加密块格式

RFC 2313定义了加密块（EB）的格式：

```
EB = 00 || BT || PS || 00 || D
```

**组成部分**：
- `00`：起始字节
- `BT`：块类型（Block Type）
- `PS`：填充字符串（Padding String）
- `00`：分隔符
- `D`：数据

### 块类型

**BT = 00**：用于私钥操作
- PS由00字节组成
- 用于签名

**BT = 01**：用于私钥操作
- PS由FF字节组成
- 用于签名，更安全

**BT = 02**：用于公钥操作
- PS由伪随机非零字节组成
- 用于加密

### 加密步骤

1. **格式化数据块**：将数据D格式化为加密块EB
2. **转换为整数**：将EB转换为整数x
3. **RSA运算**：计算 y = x^e mod n（使用公钥）
4. **转换为字节串**：将y转换为加密数据ED

## 解密过程

### 解密步骤

1. **转换为整数**：将加密数据ED转换为整数y
2. **RSA运算**：计算 x = y^d mod n（使用私钥）
3. **转换为字节串**：将x转换为加密块EB
4. **解析数据块**：从EB中提取数据D

### 填充验证

解密时必须验证：
- EB的第一个字节是00
- 块类型BT正确
- 填充字符串PS符合规范
- 存在00分隔符

## 数字签名算法

### 签名过程

RFC 2313定义了三种签名算法，用于签名X.509证书等对象：

1. **md2WithRSAEncryption**：使用MD2消息摘要
2. **md4WithRSAEncryption**：使用MD4消息摘要
3. **md5WithRSAEncryption**：使用MD5消息摘要

**签名步骤**：
1. 使用消息摘要算法计算内容的摘要
2. 将摘要封装在DigestInfo结构中
3. 使用私钥对DigestInfo进行RSA加密

### DigestInfo结构

```asn1
DigestInfo ::= SEQUENCE {
  digestAlgorithm DigestAlgorithmIdentifier,
  digest Digest
}

Digest ::= OCTET STRING
```

### 验证过程

**签名验证步骤**：
1. 使用公钥对签名进行RSA解密
2. 解析得到DigestInfo结构
3. 使用相同的消息摘要算法计算内容的摘要
4. 比较计算的摘要与DigestInfo中的摘要

## 应用场景

### 数字签名应用

**证书签名**：
- X.509数字证书
- 证书撤销列表（CRL）
- PKCS #6扩展证书

**消息签名**：
- 电子邮件签名（PEM）
- 文档签名
- 代码签名

### 数字信封应用

**加密通信**：
- 内容使用对称密钥加密（如DES）
- 对称密钥使用RSA公钥加密
- 接收方使用RSA私钥解密对称密钥
- 使用对称密钥解密内容

**优势**：
- 结合了对称加密的高效性
- 结合了非对称加密的密钥分发便利性

## 安全考虑

### 已知攻击

**选择密文攻击**：
- 攻击者可能构造特殊的密文
- PKCS #1 v1.5的填充方案存在一定脆弱性
- 后续版本（v2.0及以上）使用OAEP填充改进了安全性

**小公钥指数攻击**：
- 使用e=3时需要特别注意
- 必须使用适当的填充
- 避免对相同消息使用相同的小指数加密

### 安全建议

**密钥长度**：
- 1024位是当时的最小推荐长度
- 现代应用应使用2048位或更长
- 关键应用建议使用3072位或4096位

**随机数生成**：
- 填充字符串PS必须使用密码学安全的随机数生成器
- 素数p和q的选择必须真正随机

## 协议演进

### 后续版本

**RFC 2437 (PKCS #1 v2.0, 1998年10月)**：
- 引入了OAEP（Optimal Asymmetric Encryption Padding）
- 引入了PSS（Probabilistic Signature Scheme）
- 提供了更强的安全性证明

**RFC 3447 (PKCS #1 v2.1, 2003年2月)**：
- 进一步改进和完善
- 成为广泛使用的标准版本

**RFC 8017 (PKCS #1 v2.2, 2016年11月)**：
- 当前最新版本
- 更新了安全建议和算法标识符

### 与其他标准的关系

**X.509**：
- RFC 2313的公钥语法与X.509完全兼容
- 可以直接在X.509证书中使用

**PEM（Privacy-Enhanced Mail）**：
- RFC 2313与PEM方法兼容
- 支持PEM格式的密钥和证书

## 相关RFC文档

**消息摘要算法**：
- RFC 1319：MD2消息摘要算法
- RFC 1320：MD4消息摘要算法
- RFC 1321：MD5消息摘要算法

**相关PKCS标准**：
- PKCS #6：扩展证书语法
- PKCS #7：密码消息语法
- PKCS #8：私钥信息语法

## 相关链接

- [RFC 1186](RFC1186.md) - MD4消息摘要算法
- [RFC 1321](RFC1321.md) - MD5消息摘要算法
- [RFC 2104](RFC2104.md) - HMAC：基于哈希的消息认证码

## 总结

RFC 2313作为PKCS #1 Version 1.5的标准定义，是RSA算法在互联网标准中的首次正式化。该文档详细定义了RSA密钥的生成、语法、加密解密过程以及数字签名算法，为RSA在互联网应用中的广泛部署奠定了基础。

**主要贡献**：

1. **标准化RSA使用**：首次在RFC系列中正式定义RSA算法的使用方法
2. **密钥格式定义**：定义了与X.509兼容的公钥和私钥ASN.1语法
3. **填充方案**：定义了三种块类型的填充方案
4. **数字签名**：定义了与MD2、MD4、MD5结合的签名算法
5. **互操作性**：促进了不同实现之间的互操作性

**历史意义**：

RFC 2313标志着RSA算法从专利保护的商业产品向开放互联网标准的重要转变。1998年正值RSA专利即将到期（2000年到期），该标准的发布为RSA在互联网中的广泛应用铺平了道路。

**现代应用**：

虽然PKCS #1 v1.5已被后续版本（v2.0、v2.1、v2.2）取代，但其定义的基本概念和密钥格式仍在广泛使用。现代应用应使用RFC 3447或RFC 8017定义的更安全的填充方案（OAEP和PSS），但仍需要理解v1.5以保持向后兼容性。

**安全警告**：

PKCS #1 v1.5的填充方案存在已知的安全问题，特别是容易受到选择密文攻击（如Bleichenbacher攻击）。新的应用应使用OAEP填充进行加密，使用PSS进行签名。然而，由于广泛的部署基础，v1.5填充在许多遗留系统中仍在使用。

## 参考资料

- RFC 2313: PKCS #1: RSA Encryption Version 1.5
- RFC 2437: PKCS #1: RSA Cryptography Specifications Version 2.0
- RFC 3447: PKCS #1: RSA Cryptography Specifications Version 2.1
- RFC 8017: PKCS #1: RSA Cryptography Specifications Version 2.2
- Rivest, R., Shamir, A., and Adleman, L.: "A Method for Obtaining Digital Signatures and Public-Key Cryptosystems" (1978)
- Bleichenbacher, D.: "Chosen Ciphertext Attacks Against Protocols Based on the RSA Encryption Standard PKCS #1" (1998)
