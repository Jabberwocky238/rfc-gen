---
description: RFC 2437 - PKCS #1 RSA密码学规范版本2.0，由RSA实验室的Burton S. Kaliski Jr.和Jessica Staddon于1998年10月发布，取代RFC 2313，引入了OAEP填充方案和PSS签名方案，提供了更强的安全性保证，是RSA标准的重要改进版本
keywords:
  - RFC2437
  - PKCS #1
  - RSA
  - RSA Cryptography
  - OAEP
  - Optimal Asymmetric Encryption Padding
  - PSS
  - Probabilistic Signature Scheme
  - 公钥加密
  - Public Key Cryptography
  - 数字签名
  - Digital Signature
  - 密码学
  - Cryptography
  - RSA Laboratories
  - 非对称加密
  - 安全填充
properties:
  rfc_number: 2437
  title: "PKCS #1: RSA Cryptography Specifications Version 2.0"
  authors:
    - name: "Burton S. Kaliski Jr."
      organization: "RSA Laboratories"
    - name: "Jessica Staddon"
      organization: "RSA Laboratories"
  publication_date: "1998-10"
  status: "信息性备忘录（已被RFC 3447取代）"
  category: "密码学标准"
  obsoletes: "RFC 2313"
  obsoleted_by: "RFC 3447"
  related_rfc:
    - "RFC 2313"
    - "RFC 3447"
    - "RFC 8017"
---
# RFC 2437 - PKCS #1: RSA密码学规范 Version 2.0

## 文档概述

RFC 2437是由RSA实验室的Burton S. Kaliski Jr.和Jessica Staddon于1998年10月发布的信息性备忘录，标题为"PKCS #1: RSA Cryptography Specifications Version 2.0"。该文档是RFC 2313的后继版本，对RSA加密标准进行了重要改进和扩展。

RFC 2437引入了两个重要的新特性：
1. **RSAES-OAEP**：基于最优非对称加密填充（OAEP）的加密方案
2. **改进的安全性**：提供了更强的安全性证明和抗攻击能力

同时，该文档保留了PKCS #1 v1.5的加密和签名方案以保持向后兼容性，但推荐新应用使用OAEP方案。

## 历史背景

### 从v1.5到v2.0的演进

RFC 2313（PKCS #1 v1.5）发布仅6个月后，RSA实验室就发布了v2.0版本。这次快速迭代的主要原因是：

1. **安全性改进需求**：1998年，Daniel Bleichenbacher发现了针对PKCS #1 v1.5填充的选择密文攻击
2. **学术研究进展**：Bellare和Rogaway提出的OAEP方案提供了可证明的安全性
3. **标准化需求**：需要与ANSI X9F1和IEEE P1363等标准保持兼容

### 主要改进

**相对于RFC 2313的改进**：

1. **新增OAEP加密方案**：提供可证明安全的加密
2. **更清晰的原语定义**：明确定义了加密、解密、签名、验证的基本原语
3. **掩码生成函数**：引入MGF1（Mask Generation Function）
4. **更灵活的哈希函数支持**：支持多种哈希算法
5. **保持向后兼容**：继续支持v1.5的方案

## 核心概念

### 密钥类型

RFC 2437定义了两种密钥类型，与RFC 2313相同：

**RSA公钥**：
- 模数 n
- 公钥指数 e

**RSA私钥**：
- 模数 n
- 私钥指数 d
- 可选：素数因子 p, q 及相关参数（用于CRT优化）

### 密码学原语

RFC 2437明确定义了四个基本原语：

**加密和解密原语**：
- **RSAEP**：RSA加密原语
- **RSADP**：RSA解密原语

**签名和验证原语**：
- **RSASP1**：RSA签名原语
- **RSAVP1**：RSA验证原语

## RSAES-OAEP加密方案

### OAEP概述

OAEP（Optimal Asymmetric Encryption Padding）是由Bellare和Rogaway提出的填充方案，具有以下特点：

1. **可证明安全**：在随机预言模型下可证明安全
2. **抗选择密文攻击**：有效防御Bleichenbacher攻击
3. **使用哈希函数**：基于哈希函数的安全性

### OAEP加密过程

**EME-OAEP编码**：
1. 对消息M进行填充
2. 使用哈希函数和掩码生成函数（MGF）
3. 生成编码后的消息EM

**加密步骤**：
1. 使用EME-OAEP编码消息
2. 将编码消息转换为整数
3. 应用RSAEP原语
4. 转换为密文

### 掩码生成函数MGF1

MGF1是RFC 2437引入的关键组件：

**功能**：从种子生成任意长度的掩码
**基于**：迭代应用哈希函数
**用途**：在OAEP中混淆数据

## RSAES-PKCS1-v1_5加密方案

### 向后兼容

RFC 2437保留了v1.5的加密方案以保持向后兼容：

**EME-PKCS1-v1_5编码**：
- 与RFC 2313相同的填充方案
- 块类型BT = 02
- 使用随机非零字节填充

**使用建议**：
- 推荐新应用使用RSAES-OAEP
- 仅为兼容现有系统保留v1.5方案

## RSASSA-PKCS1-v1_5签名方案

### 签名方案

RFC 2437的签名方案与RFC 2313基本相同：

**EMSA-PKCS1-v1_5编码**：
- 使用DigestInfo结构
- 支持多种哈希算法（SHA-1、MD2、MD5等）
- 与v1.5完全兼容

**签名过程**：
1. 计算消息的哈希值
2. 使用EMSA-PKCS1-v1_5编码
3. 应用RSASP1签名原语

## 安全考虑

### OAEP的安全性

**优势**：
- 在随机预言模型下可证明安全
- 有效抵御选择密文攻击
- 不受Bleichenbacher攻击影响

**要求**：
- 必须使用密码学安全的随机数生成器
- 哈希函数必须具有抗碰撞性

### v1.5方案的安全性

**已知问题**：
- 容易受到Bleichenbacher选择密文攻击
- 不建议用于新应用
- 仅为向后兼容保留

**缓解措施**：
- 实现时必须小心处理错误信息
- 避免泄露填充验证失败的时间信息

## 与RFC 2313的对比

### 主要区别

**新增内容**：
1. RSAES-OAEP加密方案
2. MGF1掩码生成函数
3. 明确的密码学原语定义
4. 更详细的安全性分析

**保留内容**：
- RSAES-PKCS1-v1_5加密方案
- RSASSA-PKCS1-v1_5签名方案
- 密钥语法（完全兼容）

### 推荐使用

**RFC 2437的建议**：
- 新应用应使用RSAES-OAEP进行加密
- 签名可继续使用RSASSA-PKCS1-v1_5
- 仅在必须兼容旧系统时使用v1.5加密

## 协议演进

### 后续版本

**RFC 3447 (PKCS #1 v2.1, 2003年)**：
- 引入PSS签名方案
- 改进OAEP参数
- 成为最广泛使用的版本

**RFC 8017 (PKCS #1 v2.2, 2016年)**：
- 当前最新版本
- 更新安全建议
- 废弃不安全的哈希算法

## 相关链接

- [RFC 2313](RFC2313.md) - PKCS #1: RSA加密 Version 1.5（被本文档取代）
- [RFC 1186](RFC1186.md) - MD4消息摘要算法
- [RFC 1321](RFC1321.md) - MD5消息摘要算法

## 总结

RFC 2437作为PKCS #1 Version 2.0，是RSA标准发展史上的重要里程碑。该文档在RFC 2313发布仅6个月后推出，主要是为了应对新发现的安全漏洞和引入更安全的加密方案。

**主要贡献**：

1. **引入OAEP**：提供可证明安全的加密方案，有效抵御选择密文攻击
2. **MGF1函数**：定义了掩码生成函数，成为后续标准的基础
3. **明确的原语**：清晰定义了加密、解密、签名、验证的基本操作
4. **向后兼容**：保留v1.5方案，确保与现有系统的互操作性
5. **安全性证明**：在随机预言模型下提供安全性证明

**历史意义**：

RFC 2437标志着RSA标准从简单的填充方案向可证明安全的现代密码学方案的转变。OAEP的引入不仅解决了v1.5的安全问题，还为后续的密码学标准设计提供了重要参考。

**快速迭代的原因**：

1998年是RSA标准发展的关键年份。3月发布RFC 2313后，密码学界很快发现了v1.5填充的安全问题。RSA实验室迅速响应，在10月就发布了包含OAEP的v2.0版本，展示了密码学标准制定中对安全性的高度重视。

**现代应用**：

虽然RFC 2437已被RFC 3447取代，但其引入的OAEP方案仍在广泛使用。现代TLS、SSH、PGP等协议都支持OAEP加密。MGF1掩码生成函数也成为许多密码学标准的基础组件。

**安全建议**：

- 新应用应使用RFC 3447或RFC 8017定义的最新版本
- 加密必须使用OAEP，不要使用v1.5填充
- 签名建议使用PSS方案（在RFC 3447中引入）
- 避免使用MD5和SHA-1等已被攻破的哈希算法

## 参考资料

- RFC 2313: PKCS #1: RSA Encryption Version 1.5
- RFC 2437: PKCS #1: RSA Cryptography Specifications Version 2.0
- RFC 3447: PKCS #1: RSA Cryptography Specifications Version 2.1
- RFC 8017: PKCS #1: RSA Cryptography Specifications Version 2.2
- Bellare, M. and Rogaway, P.: "Optimal Asymmetric Encryption" (1994)
- Bleichenbacher, D.: "Chosen Ciphertext Attacks Against Protocols Based on the RSA Encryption Standard PKCS #1" (1998)
