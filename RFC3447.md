---
description: RFC 3447 - PKCS #1 RSA密码学规范版本2.1，由RSA实验室的Jakob Jonsson和Burton S. Kaliski Jr.于2003年2月发布，取代RFC 2437，引入了PSS签名方案，改进了OAEP参数，成为最广泛使用的RSA标准版本
keywords:
  - RFC3447
  - PKCS #1
  - RSA
  - RSA Cryptography
  - PSS
  - Probabilistic Signature Scheme
  - OAEP
  - RSASSA-PSS
  - RSAES-OAEP
  - 公钥加密
  - 数字签名
  - 密码学标准
  - RSA Laboratories
properties:
  rfc_number: 3447
  title: "PKCS #1: RSA Cryptography Specifications Version 2.1"
  authors:
    - name: "Jakob Jonsson"
      organization: "RSA Laboratories"
    - name: "Burton S. Kaliski Jr."
      organization: "RSA Laboratories"
  publication_date: "2003-02"
  status: "信息性备忘录（已被RFC 8017取代）"
  category: "密码学标准"
  obsoletes: "RFC 2437"
  obsoleted_by: "RFC 8017"
  related_rfc:
    - "RFC 2313"
    - "RFC 2437"
    - "RFC 8017"
---
# RFC 3447 - PKCS #1: RSA密码学规范 Version 2.1

## 文档概述

RFC 3447是由RSA实验室的Jakob Jonsson和Burton S. Kaliski Jr.于2003年2月发布的信息性备忘录，标题为"PKCS #1: RSA Cryptography Specifications Version 2.1"。该文档是RFC 2437的后继版本，代表了PKCS #1标准的重要改进。

**RFC 3447的主要特点**：

1. **引入PSS签名方案**：提供可证明安全的签名方案
2. **改进OAEP**：优化了OAEP的参数和实现
3. **更完善的规范**：提供更详细的实现指导
4. **广泛采用**：成为最广泛使用的RSA标准版本

RFC 3447在发布后的十多年里一直是RSA加密和签名的主要标准，直到2016年被RFC 8017 (v2.2)取代。

## 历史背景

### 从v2.0到v2.1的演进

RFC 2437 (v2.0)在1998年10月发布后，密码学界继续对RSA方案进行研究和改进。到2003年，积累了足够的改进和经验，促成了v2.1的发布：

**主要改进动机**：

1. **PSS签名方案**：Bellare和Rogaway提出的PSS提供了可证明安全的签名
2. **OAEP优化**：基于实践经验改进OAEP的参数选择
3. **规范完善**：修正v2.0中的一些不明确之处
4. **标准兼容**：与IEEE P1363等标准保持一致

### 版本演进时间线

- **1998年3月**：RFC 2313 (PKCS #1 v1.5)
- **1998年10月**：RFC 2437 (PKCS #1 v2.0) - 引入OAEP
- **2003年2月**：RFC 3447 (PKCS #1 v2.1) - 引入PSS
- **2016年11月**：RFC 8017 (PKCS #1 v2.2) - 当前版本

## 核心方案

### RSAES-OAEP加密方案

RFC 3447保留并改进了RFC 2437引入的OAEP加密方案：

**改进点**：
- 更灵活的参数选择
- 改进的标签（label）处理
- 更清晰的安全性分析

**继续使用**：
- MGF1掩码生成函数
- 可证明安全性
- 抗选择密文攻击

### RSASSA-PSS签名方案

RFC 3447的最重要创新是引入PSS（Probabilistic Signature Scheme）：

**PSS的特点**：
1. **可证明安全**：在随机预言模型下可证明安全
2. **概率性**：使用随机盐值，相同消息产生不同签名
3. **抗存在性伪造**：有效防御各种签名伪造攻击
4. **灵活性**：支持可调整的安全参数

**EMSA-PSS编码**：
- 使用哈希函数和MGF1
- 包含随机盐值
- 提供更强的安全保证

### 向后兼容方案

RFC 3447继续支持旧版方案以保持兼容性：

**RSAES-PKCS1-v1_5**：
- 保留v1.5加密方案
- 不推荐新应用使用
- 仅用于兼容遗留系统

**RSASSA-PKCS1-v1_5**：
- 保留v1.5签名方案
- 仍然广泛使用
- 但推荐新应用使用PSS

## 与前版本的对比

### 相对RFC 2437的改进

**新增内容**：
1. **RSASSA-PSS签名方案**：提供可证明安全的签名
2. **EMSA-PSS编码方法**：PSS的编码实现
3. **改进的OAEP参数**：更灵活的参数选择
4. **更详细的规范**：修正了v2.0的一些不明确之处

**保留内容**：
- RSAES-OAEP加密方案
- RSAES-PKCS1-v1_5加密方案
- RSASSA-PKCS1-v1_5签名方案
- MGF1掩码生成函数
- 密钥语法

### 推荐使用

**RFC 3447的建议**：
- **加密**：使用RSAES-OAEP
- **签名**：推荐使用RSASSA-PSS
- **兼容性**：必要时可使用v1.5方案

## 安全考虑

### PSS的安全性

**优势**：
- 在随机预言模型下可证明安全
- 抗存在性伪造攻击
- 提供紧致的安全性归约

**要求**：
- 必须使用密码学安全的随机数生成器生成盐值
- 哈希函数必须具有抗碰撞性

### OAEP的安全性

**继续保持**：
- 在随机预言模型下可证明安全
- 有效抵御选择密文攻击
- 不受Bleichenbacher攻击影响

### v1.5方案的安全性

**已知问题**：
- 加密方案容易受到选择密文攻击
- 签名方案相对安全但不提供可证明安全性
- 不推荐新应用使用v1.5加密

## 实际应用

### 广泛采用

RFC 3447成为最广泛使用的RSA标准：

**应用领域**：
- TLS/SSL协议
- SSH协议
- PGP/GPG加密
- S/MIME邮件加密
- 代码签名
- 数字证书

### PSS的采用情况

**逐步采用**：
- TLS 1.3强制要求支持PSS
- 新版本的SSH推荐使用PSS
- 现代证书颁发机构开始使用PSS签名

**兼容性考虑**：
- 许多系统仍使用v1.5签名以保持兼容
- PSS和v1.5可以共存

## 协议演进

### 后续版本

**RFC 8017 (PKCS #1 v2.2, 2016年)**：
- 更新安全建议
- 废弃不安全的哈希算法（MD2、MD5）
- 推荐使用SHA-256或更强的哈希
- 更新算法标识符

## 相关链接

- [RFC 2313](RFC2313.md) - PKCS #1: RSA加密 Version 1.5
- [RFC 2437](RFC2437.md) - PKCS #1: RSA密码学规范 Version 2.0（被本文档取代）
- [RFC 1186](RFC1186.md) - MD4消息摘要算法
- [RFC 1321](RFC1321.md) - MD5消息摘要算法

## 总结

RFC 3447作为PKCS #1 Version 2.1，是RSA标准发展史上最成功和最广泛使用的版本。该文档在RFC 2437的基础上引入了PSS签名方案，为RSA签名提供了可证明的安全性。

**主要贡献**：

1. **引入PSS签名**：提供可证明安全的签名方案，有效防御存在性伪造攻击
2. **改进OAEP**：优化参数选择，提供更清晰的实现指导
3. **完善规范**：修正v2.0的不明确之处，提供更详细的技术规范
4. **保持兼容**：继续支持v1.5和v2.0的方案，确保互操作性
5. **广泛采用**：成为工业界最广泛使用的RSA标准

**历史意义**：

RFC 3447在2003年发布后，迅速成为RSA加密和签名的事实标准。其引入的PSS签名方案代表了密码学从启发式设计向可证明安全设计的重要转变。该标准在长达13年的时间里（2003-2016）一直是RSA的主要参考标准，直到RFC 8017发布。

**长期影响**：

1. **TLS/SSL演进**：PSS成为TLS 1.3的强制要求
2. **证书标准**：影响了X.509证书的签名算法选择
3. **密码学教育**：成为密码学课程中RSA的标准参考
4. **工业实践**：被主流密码学库广泛实现

**现代应用**：

虽然RFC 3447已被RFC 8017取代，但其定义的方案仍在广泛使用。现代应用中：
- OAEP仍是推荐的RSA加密方案
- PSS逐渐取代v1.5成为主流签名方案
- 主流密码学库（OpenSSL、BoringSSL、mbedTLS等）完整实现了RFC 3447

**安全建议**：

- 新应用应使用RFC 8017或遵循RFC 3447的建议
- 加密必须使用OAEP，避免使用v1.5填充
- 签名推荐使用PSS，但v1.5签名仍可接受
- 避免使用MD5和SHA-1，推荐SHA-256或更强的哈希算法
- 密钥长度至少2048位，关键应用建议3072位或4096位

## 参考资料

- RFC 2313: PKCS #1: RSA Encryption Version 1.5
- RFC 2437: PKCS #1: RSA Cryptography Specifications Version 2.0
- RFC 3447: PKCS #1: RSA Cryptography Specifications Version 2.1
- RFC 8017: PKCS #1: RSA Cryptography Specifications Version 2.2
- Bellare, M. and Rogaway, P.: "PSS: Provably Secure Encoding Method for Digital Signatures" (1996)
- Bellare, M. and Rogaway, P.: "Optimal Asymmetric Encryption" (1994)
